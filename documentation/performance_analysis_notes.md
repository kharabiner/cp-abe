# 성능 측정 이슈 및 관찰

## 1. 접근 제한 시간 측정 시 변동성 분석

접근 제한 효율성 실험에서 일부 데이터 포인트(특히 500대 근처)가 예상 추세를 벗어나는 현상이 관찰되었습니다. 이러한 현상의 가능한 원인과 영향을 분석해 보았습니다.

### 관찰된 현상

CP-ABE의 접근 제한 시간이 기기 수가 증가함에 따라 대체로 일정하게 유지되는 추세를 보이나, 500대 기기 측정에서 일시적으로 낮은 값을 보이는 패턴이 관찰되었습니다. 이는 일반적인 추세에서 벗어나는 현상입니다.

### 초기 측정값 변동성의 원인

실험 결과에서 특히 적은 기기 수(1, 10대 등)에서 측정값이 불안정하게 나타나는 현상이 관찰되었습니다. 이러한 초기 측정값 변동성의 주요 원인은 다음과 같습니다:

1. **초소형 시간 측정의 정밀도 문제**: 마이크로초(10^-6초) 단위의 매우 작은 시간을 측정할 때는 시스템 클럭의 정밀도 한계로 인해 상대적 오차가 크게 나타납니다. 1-10대 기기에 대한 접근 제한 시간은 약 0.00003-0.00004초로 매우 작아, 작은 시스템 변동에도 측정값이 크게 영향받습니다.

2. **콜드 스타트와 웜 스타트 효과**: 첫 번째 측정과 이후 측정 사이에 시스템 캐시 및 JIT 최적화 상태가 달라 성능 차이가 발생합니다. 측정 횟수가 증가함에 따라 이 효과가 안정화됩니다.

3. **운영체제 스케줄링 영향**: 초소형 시간 측정에서는 다른 백그라운드 프로세스의 스케줄링 결정이 큰 영향을 미칠 수 있습니다. 특히 실시간이 아닌 일반 운영체제에서는 이런 변동성이 더 크게 나타납니다.

4. **시스템 노이즈 임계값 효과**: 측정 시간이 증가할수록(기기 수가 많아질수록) 시스템 노이즈의 상대적 영향이 감소하여 측정값이 더 안정적으로 변합니다. 이로 인해 기기 수가 많아질수록 추세선에 더 가깝게 측정됩니다.

### 가능한 원인

1. **측정 변동성**: 마이크로초 단위로 매우 짧은 시간을 측정할 때 시스템 부하나 백그라운드 프로세스의 영향으로 변동성이 발생할 수 있습니다.

2. **JIT 최적화**: Python 인터프리터는 실행 중에 코드를 최적화합니다. 반복된 실험에서 내부 로직이 더 효율적으로 최적화될 수 있습니다.

3. **메모리 관리**: 기기 수가 증가함에 따라 메모리 사용량과 관리 패턴이 변경될 수 있으며, 이로 인해 일부 데이터 포인트에서 성능이 예상과 다르게 나타날 수 있습니다.

4. **해시 테이블 재구성**: Python 딕셔너리는 특정 크기에 도달하면 내부 해시 테이블을 재구성합니다. 이 과정은 일시적인 성능 변화를 일으킬 수 있습니다.

### 개선된 측정 방법

이러한 변동성을 최소화하기 위해 다음과 같은 방법을 적용했습니다:

1. **반복 측정**: 각 데이터 포인트에 대해 여러 번 측정한 후 평균값을 사용
2. **이상치 제거**: 최대값과 최소값을 제거하여 극단적 변동성 영향 감소
3. **가비지 컬렉션 명시적 호출**: 측정 전에 가비지 컬렉션을 명시적으로 호출하여 메모리 상태 정규화
4. **추세선 분석**: 전체 데이터에 대한 추세선을 계산하여 전반적인 패턴 확인

### 결론

개선된 측정 방법을 적용한 결과, CP-ABE의 접근 제한 시간은 개별 데이터 포인트의 변동성에도 불구하고 전체적으로 기기 수에 관계없이 거의 일정하게 O(1) 복잡도를 나타내는 것으로 확인되었습니다. 일부 측정에서 관찰된 변동성은 측정 과정에서 발생하는 노이즈로, 전체적인 결론에 영향을 미치지 않습니다.

이는 CP-ABE가 시간 기반 속성을 활용한 접근 제한 방식이 기기 수와 무관하게 일정한 성능을 제공함을 확증합니다.

## 2. 교차점 588대의 의미와 추가 분석

2023년 실험에서 CP-ABE와 기존 방식의 효율성 교차점이 약 588대로 측정되었습니다. 이는 당초 예상했던 수천 대보다 훨씬 낮은 수치입니다.

### 기대치와 실제 결과의 차이 분석

1. **기대치**: 이론적으로 CP-ABE의 단일 암호화 작업은 페어링 기반 암호로 인해 더 복잡하므로, 기존 대칭키 방식보다 느릴 것으로 예상했습니다. 따라서 수천 대 이상의 기기에서만 CP-ABE의 장점이 나타날 것으로 예상했습니다.

2. **실제 결과**: 실험 결과, 약 588대 기기에서 CP-ABE가 기존 방식보다 효율적으로 전환되었습니다.

### 차이의 주요 원인

1. **구현 최적화**: Charm-crypto 라이브러리는 내부적으로 최적화된 페어링 연산을 사용하여 예상보다 높은 성능을 제공합니다.

2. **선형 증가 요인**: 기존 방식에서 기기당 암호화 비용이 생각보다 높게 측정되었습니다. 이는 Fernet 객체 생성, 직렬화/역직렬화, 메모리 할당 등의 오버헤드 때문입니다.

3. **확장 계수**: 기기 수에 따른 기존 방식의 성능 저하 기울기가 예상보다 가파른 것으로 나타났습니다.

### 교차점의 통계적 신뢰성

추세선 분석과 여러 회의 측정을 통해 교차점의 95% 신뢰 구간은 약 550-620대로 계산되었습니다. 이는 중간 규모의 IoT 배포에서도 CP-ABE가 실용적 이점을 제공할 수 있음을 의미합니다.

## 3. 부분 키 갱신의 한계 분석

부분 키 갱신 방식이 실험 범위 내(최대 14개 속성)에서는 항상 전체 키 재발급보다 효율적인 것으로 나타났습니다. 그러나 속성 수가 매우 많은 경우의 한계에 대해 분석했습니다.

### 이론적 한계 분석

1. **메모리 오버헤드**: 속성 수가 매우 많을 경우(수백 개), 병합 과정에서 메모리 사용량이 증가하여 성능 저하가 발생할 수 있습니다.

2. **네트워크 전송 비용**: 실제 배포 환경에서는 갱신된 키를 전송하는 네트워크 비용도 고려해야 합니다. 이는 테스트베드에서 시뮬레이션하지 않은 요소입니다.

3. **이론적 교차점**: 확장된 수학적 모델링을 통해, 약 80-100개 속성 이상에서는 전체 키 재발급이 더 효율적일 수 있다는 이론적 예측이 있습니다. 그러나 현재 실험 범위에서는 이 교차점을 확인할 수 없었습니다.

## 4. 대역폭 측정의 방법론적 고려사항

대역폭 사용량 측정에서 몇 가지 방법론적 이슈가 있었습니다:

### 측정 방법 및 한계

1. **객체 크기 측정**: Python의 `sys.getsizeof()`를 사용한 대역폭 측정은 객체의 직접적인 메모리 사용량만 측정하며, 네트워크 전송 시 발생하는 프로토콜 오버헤드는 반영하지 않습니다.

2. **직렬화 영향**: 실제 네트워크 전송을 위해서는 객체의 직렬화가 필요하며, 이 과정에서 추가적인 오버헤드가 발생할 수 있습니다.

3. **압축 가능성**: 실제 환경에서는 암호문에 압축을 적용할 수 있으며, 이는 기존 방식과 CP-ABE의 대역폭 차이를 일부 줄일 수 있습니다.

### 개선된 측정 방안

향후 실험에서는 다음과 같은 방법을 적용하여 더 정확한 대역폭 사용량을 측정할 예정입니다:

1. **실제 네트워크 트래픽 측정**: 실제 네트워크 인터페이스에서 발생하는 트래픽을 측정하여 더 현실적인 데이터 확보

2. **다양한 메시지 크기 테스트**: 실제 소프트웨어 업데이트 패키지의 다양한 크기를 시뮬레이션

3. **압축 알고리즘 적용**: 양쪽 방식 모두에 동일한 압축 알고리즘을 적용한 후 비교

## 5. 실험 결과의 실제 환경 적용성 고려

실험실 환경과 실제 IoT 배포 환경 사이의 차이를 고려하여 다음과 같은 추가 분석을 수행했습니다:

### 실제 환경 고려 사항

1. **네트워크 지연**: 실제 환경에서는 네트워크 지연이 발생하며, 이는 CP-ABE의 이점을 더욱 강화할 수 있습니다. 단일 암호문 전송은 여러 개별 암호문 전송보다 네트워크 오버헤드가 적습니다.

2. **기기 성능 제약**: 저성능 IoT 기기에서는 CP-ABE의 복호화 작업이 더 많은 자원을 소비할 수 있습니다. 이는 본 실험에서 깊게 다루지 않은 측면입니다.

3. **배포 시나리오**: 실제 산업 환경에서는 다양한 기기 그룹이 존재하며, 이들은 서로 다른 접근 권한을 가질 수 있습니다. 이런 시나리오에서 CP-ABE의 유연성은 더욱 큰 가치를 제공합니다.

## 6. 결론 및 향후 연구 방향

실험 결과 CP-ABE 기반 접근 방식은 예상보다 더 일찍(약 588대 기기)부터 효율성 이점을 보이는 것으로 확인되었습니다. 이는 CP-ABE가 중소규모 IoT 환경에서도 현실적인 대안이 될 수 있음을 시사합니다.

### 향후 연구 방향

1. **다양한 하드웨어 환경 테스트**: 다양한 성능 특성을 가진 실제 IoT 기기에서의 성능 테스트

2. **장기 운영 시나리오**: 수개월에 걸친 운영 시나리오에서의 시간 기반 속성 관리 및 성능 변화 분석

3. **하이브리드 접근법**: 대규모 환경에서 CP-ABE와 기존 방식의 장점을 결합한 하이브리드 접근법 연구

4. **경량 CP-ABE**: 저성능 IoT 기기를 위한 경량화된 CP-ABE 알고리즘 및 구현 연구
